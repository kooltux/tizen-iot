/*
 * Controller for handling all actions related to event
 *
 */

var log4js=require("log4js");
var logger=log4js.getLogger("event");
var net=require('net');

module.exports = function(app,prefix) {
	var wwwserv=this; // wwwserver instance
	
	// initialize target list
	var EVENTS=[];

	// declare routes on express app
	app.get(prefix+'state',function(req,res) {
		res.json({events: EVENTS});
	});
	
	app.get(prefix+'post',function(req,res) {
		var evt={
			x: req.query.x,
			y: req.query.y,
			state: req.query.state
		};
		EVENTS.unshift(evt);
		while (EVENTS.length>20) {	
			EVENTS.pop();
		}

		//console.log("Got event: "+JSON.stringify(evt)+" - "+(EVENTS.length)+" events total");

		res.end("OK");
	});
};
